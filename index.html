<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Service Status Monitor</title>
<style>
body {
  background: #0f172a;
  color: white;
  font-family: Arial, sans-serif;
  padding: 40px;
}

h1 {
  margin-bottom: 10px;
}

#countdown {
  margin-bottom: 30px;
  font-size: 18px;
  opacity: 0.8;
}

.service {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: #1e293b;
  padding: 15px 20px;
  margin-bottom: 12px;
  border-radius: 12px;
}

.status-box {
  padding: 8px 16px;
  border-radius: 999px;
  font-weight: bold;
  min-width: 140px;
  text-align: center;
}

.operational {
  background: #16a34a;
}

.minor {
  background: #eab308;
  color: black;
}

.major {
  background: #dc2626;
}

.error {
  background: #6b7280;
}
</style>
</head>
<body>

<h1>Global Service Monitor</h1>
<div id="countdown">Refreshing in: 60s</div>

<div id="services"></div>

<script>
const backendURL = "https://site-checker-backend-qmhr.onrender.com/api/status";

const presetServices = [
  "Discord",
  "Cloudflare",
  "GitHub",
  "OpenAI",
  "Reddit",
  "Twitch",
  "Amazon Web Services (AWS)",
  "Google Cloud"
];

let countdown = 60;

function renderServices(data) {
  const container = document.getElementById("services");
  container.innerHTML = "";

  presetServices.forEach(name => {
    const serviceData = data.find(s => s.name === name);

    const row = document.createElement("div");
    row.className = "service";

    const title = document.createElement("div");
    title.textContent = name;

    const statusBox = document.createElement("div");
    statusBox.className = "status-box";

    let statusText = "Error";
    if (serviceData) statusText = serviceData.status;

    statusBox.textContent = statusText;

    if (statusText === "Operational") statusBox.classList.add("operational");
    else if (statusText === "Minor Issues") statusBox.classList.add("minor");
    else if (statusText === "Major Outage") statusBox.classList.add("major");
    else statusBox.classList.add("error");

    row.appendChild(title);
    row.appendChild(statusBox);
    container.appendChild(row);
  });
}

async function fetchStatus() {
  try {
    const res = await fetch(backendURL);
    const data = await res.json();
    renderServices(data);
  } catch {
    console.log("Fetch failed");
  }
}

function startCountdown() {
  setInterval(() => {
    countdown--;
    if (countdown <= 0) {
      fetchStatus();
      countdown = 60;
    }
    document.getElementById("countdown").textContent =
      "Refreshing in: " + countdown + "s";
  }, 1000);
}

fetchStatus();
startCountdown();
</script>

</body>
</html>
